/**
 * Lib de selecteur de noeuds
 * @author hakurou
 * @version 1.0.0
 */
!function(){"use strict";"undefined"==typeof window.piou&&(window.piou={});var t={qs:"undefined"!=typeof document.querySelector,getAll:function(t){if(t.all)var e=t.all;else var e=t.getElementsByTagName("*");var i=[];return this.each(e,function(){"html"!=this.nodeName.toLowerCase()&&i.push(this)}),i},getByAttr:function(e,i,s,n){if(null!=n)return this.getByAttrIn(e,i,s,n);if(null!=s)return this.getByAttrFrom(e,i,s,n);if(this.qs)return i.querySelectorAll(e[0]);var a=[],r=this.getAll(i);return this.each(r,function(){t.isAttrOk(e,this)&&a.push(this)}),a},getByAttrIn:function(e,i,s,n){var a=[];return this.each(n,function(){t.isAttrOk(e,this)&&a.push(this)}),a},getByAttrFrom:function(e,i,s){var n=[];return this.each(s,function(){var i=t.getByAttr(e,this);t.each(i,function(){n.push(this)})}),n},isAttrOk:function(t,e){if(2==t.length)return e.hasAttribute(t[1]);if(4==t.length){var i=this.regProtect(t[3]),s=null;if(s="class"==t[1]?e.className:e.hasAttribute(t[1]),"="==t[2])return s&&s==t[3];if("*="==t[2])return s&&s.match(i);if("|="==t[2])return s&&s.match(new RegExp("-"+i+"-|^"+i+"-|-"+i+"$|^"+i+"$"));if("^="==t[2])return s&&s.match("^"+i);if("$="==t[2])return s&&s.match(i+"$");if("~="==t[2])return s&&s.match(new RegExp("s+"+i+"s+|^"+i+"s+|s+"+i+"$|^"+i+"$"))}return!1},regProtect:function(t){return t=t.replace(/\./g,"\\."),t=t.replace(/\[/g,"\\["),t=t.replace(/\]/g,"\\]"),t=t.replace(/\(/g,"\\("),t=t.replace(/\)/g,"\\)"),t=t.replace(/\+/g,"\\+"),t=t.replace(/\*/g,"\\*"),t=t.replace(/\?/g,"\\?")},getById:function(t,e,i,s){return null!=s?this.getByIdIn(t,e,i,s):null!=i?this.getByIdFrom(t,e,i,s):this.qs?e.querySelector(t[0]):e.getElementById(t[1])},getByIdFrom:function(t,e,i){var s=this.getById(t,e);if(null==s)return[];var n=[],a=s;do a=a.parentNode,this.each(i,function(){a==this&&(n=[s])});while(null!=a&&null==n);return n},getByIdIn:function(t,e,i,s){var n=[];return this.each(s,function(){this.id==t[1]&&(n=[this])}),n},getByClass:function(t,e,i,s){return null!=s?this.getByClassIn(t,e,i,s):null!=i?this.getByClassFrom(t,e,i,s):this.qs?e.querySelectorAll(t[0]):"undefined"!=typeof e.getElementsByClassName?e.getElementsByClassName(t[1]):this.getByClass(t,e,i,this.getAll(e))},getByClassFrom:function(e,i,s){var n=[];return this.each(s,function(){var i=t.getByClass(e,this);t.each(i,function(){n.push(this)})}),n},getByClassIn:function(t,e,i,s){var n=[];return this.each(s,function(){this.className.match(new RegExp("s+"+t[1]+"s+|^"+t[1]+"$|s+"+t[1]+"$|^"+t[1]+"s+"))&&n.push(this)}),n},getByTag:function(t,e,i,s){return null!=s?this.getByTagIn(t,e,i,s):null!=i?this.getByTagFrom(t,e,i,s):this.qs?e.querySelectorAll(t[1]):e.getElementsByTagName(t[1])},getByTagIn:function(t,e,i,s){var n=[];return this.each(s,function(){this.nodeName.toLowerCase()==t[1].toLowerCase()&&n.push(this)}),n},getByTagFrom:function(e,i,s){var n=[];return this.each(s,function(){var i=t.getByTag(e,this);t.each(i,function(){n.push(this)})}),n},getByPseu:function(t,e,i,s){var n=[];if(null!=s)return this.getByPseuIn(t,e,i,s);if(null!=i)return this.getByPseuFrom(t,e,i,s);if(this.qs&&(n=e.querySelectorAll(t[0])),0==n.length){var a=this.getAll(e);return this.getByPseu(t,e,i,a)}return n},getByPseuIn:function(t,e,s,n){var a=[];if("undefined"!=typeof i.pseu[t[1]]){var r=null!=t[2]?t[2].split(/\s*,\s*/):[];this.each(n,function(){i.pseu[t[1]].apply(this,r)&&a.push(this)})}return a},getByPseuFrom:function(e,i,s){var n=[];return this.each(s,function(){var i=t.getByPseu(e,this);t.each(i,function(){n.push(this)})}),n},nthChild:function(t,e,i){var s=null;return 0==e|null==e&&null!=i&&i>=0?t==i:"-"==e&&null!=i?-t+parseInt(i)>=0:null!=i?(s=(t-i)/e)!==!1&&s>=0&&parseInt(s)==s:null==i?0==t%e:!1},getNodePosition:function(t,e,i){var s=0,n=0,a=!1;return this.each(t.parentNode.childNodes,function(){(null==e||t.nodeName.toLowerCase()==e)&&n++,a||s++,t!=this||null!=e&&t.nodeName.toLowerCase()!=e||(a=!0)}),i?n-s+1:s},nth:function(e,i,s,n){var a=1,r=null;return a=t.getNodePosition(e,n,s?!0:!1),"even"==i&&0==a%2||"odd"==i&&0!=a%2||i.match(/^\d+$/)&&i==a?!0:(r=i.match(/^((-|\+)?(\d+)?)n((-|\+)\d+)?$/))?t.nthChild(a,null!=r[1]?r[1]:null,null!=r[4]?r[4]:null):!1},each:function(t,e){if(null!=t&&((null==t.length||null!=t.nodeType)&&(t=[t]),t.length>0))for(var i=0,s=t.length;s>i;++i)1==t[i].nodeType&&e.call(t[i],i)}},e=function(){var e=function(t,e){this.pt={id:/^#([\w-]+)/,"class":/^\.([\w-]+)/,tag:/^([\w-]+)/,blank:/^\s+/,tilde:/^~\s+?/,add:/^\+\s+?/,children:/^>\s+?/,pseu:/^:([\w-]+)/,pseuArg:/^:([\w-]+)\(([^\)]+)\)/,attrCpx:/^\[([\w-]+)(=|\*=|\|=|\^=|\$=|~=)([^\]]+)\]/,attr:/^\[([\w-]+)\]/},this.str=t,this.context=e};return e.prototype={parse:function(t,e){this.match(this.pt.blank);var i=this.parseExp(t,e);return null!=i&&null==i.length?[i]:i},getChildrenExp:function(e,i){var s=[];return t.each(i,function(){t.each(this.childNodes,function(){s.push(this)})}),this.parseExp(e,s)},getSiblingExp:function(e,i){var s=[];return t.each(i,function(){var t=this.nextElementSibling;do 1==t.nodeType&&s.push(t),t=t.nextElementSibling;while(null!=t)}),this.parseExp(e,s)},getNextNodeExp:function(e,i){var s=[];return t.each(i,function(){for(var t=this.nextElementSibling;null!=t;){if(1==t.nodeType){s.push(t);break}t=t.nextElementSibling}}),this.parseExp(e,s)},parseExp:function(t,e){var i=this.parseBase(t,e);return this.match(this.pt.blank)&&this.str.length>0&&(i=null!=this.match(this.pt.children)?this.getChildrenExp(t,i):null!=this.match(this.pt.add)?this.getNextNodeExp(t,i):null!=this.match(this.pt.tilde)?this.getSiblingExp(t,i):this.parseExp(i,e)),i},parseBase:function(e,i){var s=null,n=null;if(null!=(n=this.match(this.pt.tag))){s=t.getByTag(n,this.context,e,i);var a=this.parseSuit(e,s);null!=a&&(s=a)}else s=this.parseSup(e,i);if(null==s)throw"piou-selector::parseBase: Error, node not found";return s},parseSuit:function(t,e){return this.parseSup(t,e)},parseSup:function(e,i){var s=null,n=null;if(null!=(n=this.match(this.pt.id))?s=t.getById(n,this.context,e,i):null!=(n=this.match(this.pt["class"]))?s=t.getByClass(n,this.context,e,i):(s=this.parsePseu(e,i),null==s&&(s=this.parseAttr(e,i))),null!=s){var n=this.parseSuit(e,s);null!=n&&(s=n)}return s},parsePseu:function(e,i){var s=null,n=null;return(null!=(n=this.match(this.pt.pseuArg))||null!=(n=this.match(this.pt.pseu)))&&(s=t.getByPseu(n,this.context,e,i)),s},parseAttr:function(e,i){var s=null,n=null;return(null!=(n=this.match(this.pt.attr))||null!=(n=this.match(this.pt.attrCpx)))&&(s=t.getByAttr(n,this.context,e,i)),s},match:function(t){var e=null;return(e=this.str.match(t))&&(this.str=this.str.substr(e[0].length)),e}},e}(),i=function(i,s){null==s&&(s=document);var n=[],a=i.split(/,/g);for(var r in a){var o=new e(a[r],s),l=o.parse();console.log(l),t.each(l,function(){n.push(this)})}return n};i.query=t,i.pseu={"first-child":function(){for(var t=this.parentNode.childNodes,e=0,i=t.length;i>e&&1!=t[e].nodeType;++e);return t[e]==this},"nth-child":function(e){return t.nth(this,e)},"nth-last-child":function(e){return t.nth(this,e,!0)},"last-child":function(){for(var t=this.parentNode.childNodes,e=t.length-1;e>0&&1!=t[e].nodeType;--e);return t[e]==this},"nth-of-type":function(e){return t.nth(this,e,!1,this.nodeName.toLowerCase())},"nth-last-of-type":function(e){return t.nth(this,e,!0,this.nodeName.toLowerCase())},"first-of-type":function(){for(var t=this.parentNode.childNodes,e=0,i=t.length;i>e&&(1!=t[e].nodeType||this.nodeName.toLowerCase()!=t[e].nodeName.toLowerCase());++e);return t[e]==this},"last-of-type":function(){for(var t=this.parentNode.childNodes,e=t.length-1;e>=0&&(1!=t[e].nodeType||this.nodeName.toLowerCase()!=t[e].nodeName.toLowerCase());--e);return t[e]==this},"only-child":function(){var e=0;return t.each(this.parentNode.childNodes,function(){e++}),1==e},empty:function(){return 0==this.childNodes.length},not:function(t){var i=new e(t,document);return 0==i.parse(null,this).length},checked:function(){return this.checked?!0:!1}},i.version="1.0.0",window.piou.selector=i}();