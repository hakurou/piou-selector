/**
 * Lib de selecteur de noeuds
 * @author hakurou
 * @version 1.0.0
 */
!function(){"use strict";"undefined"==typeof window.piou&&(window.piou={});var t={qs:"undefined"!=typeof document.querySelector,getAll:function(t){if(t.all)var e=t.all;else var e=t.getElementsByTagName("*");var n=[];return this.each(e,function(){"html"!=this.nodeName.toLowerCase()&&n.push(this)}),n},getByAttr:function(e,n,r,i){if(null!=i)return this.getByAttrIn(e,n,r,i);if(null!=r)return this.getByAttrFrom(e,n,r,i);if(this.qs)return n.querySelectorAll(e[0]);var s=[],u=this.getAll(n);return this.each(u,function(){t.isAttrOk(e,this)&&s.push(this)}),s},getByAttrIn:function(e,n,r,i){var s=[];return this.each(i,function(){t.isAttrOk(e,this)&&s.push(this)}),s},getByAttrFrom:function(e,n,r){var i=[];return this.each(r,function(){var n=t.getByAttr(e,this);t.each(n,function(){i.push(this)})}),i},isAttrOk:function(t,e){if(2==t.length)return e.hasAttribute(t[1]);if(4==t.length){var n=this.regProtect(t[3]),r=null;if(r="class"==t[1]?e.className:e.hasAttribute(t[1]),"="==t[2])return r&&r==t[3];if("*="==t[2])return r&&r.match(n);if("|="==t[2])return r&&r.match(new RegExp("-"+n+"-|^"+n+"-|-"+n+"$|^"+n+"$"));if("^="==t[2])return r&&r.match("^"+n);if("$="==t[2])return r&&r.match(n+"$");if("~="==t[2])return r&&r.match(new RegExp("s+"+n+"s+|^"+n+"s+|s+"+n+"$|^"+n+"$"))}return!1},regProtect:function(t){return t=t.replace(/\./g,"\\."),t=t.replace(/\[/g,"\\["),t=t.replace(/\]/g,"\\]"),t=t.replace(/\(/g,"\\("),t=t.replace(/\)/g,"\\)"),t=t.replace(/\+/g,"\\+"),t=t.replace(/\*/g,"\\*"),t=t.replace(/\?/g,"\\?")},getById:function(t,e,n,r){return null!=r?this.getByIdIn(t,e,n,r):null!=n?this.getByIdFrom(t,e,n,r):this.qs?e.querySelector(t[0]):e.getElementById(t[1])},getByIdFrom:function(t,e,n){var r=this.getById(t,e);if(null==r)return[];var i=[],s=r;do s=s.parentNode,this.each(n,function(){s==this&&(i=[r])});while(null!=s&&null==i);return i},getByIdIn:function(t,e,n,r){var i=[];return this.each(r,function(){this.id==t[1]&&(i=[this])}),i},getByClass:function(t,e,n,r){return null!=r?this.getByClassIn(t,e,n,r):null!=n?this.getByClassFrom(t,e,n,r):this.qs?e.querySelectorAll(t[0]):"undefined"!=typeof e.getElementsByClassName?e.getElementsByClassName(t[1]):this.getByClass(t,e,n,this.getAll(e))},getByClassFrom:function(e,n,r){var i=[];return this.each(r,function(){var n=t.getByClass(e,this);t.each(n,function(){i.push(this)})}),i},getByClassIn:function(t,e,n,r){var i=[];return this.each(r,function(){this.className.match(new RegExp("s+"+t[1]+"s+|^"+t[1]+"$|s+"+t[1]+"$|^"+t[1]+"s+"))&&i.push(this)}),i},getByTag:function(t,e,n,r){return null!=r?this.getByTagIn(t,e,n,r):null!=n?this.getByTagFrom(t,e,n,r):this.qs?e.querySelectorAll(t[1]):e.getElementsByTagName(t[1])},getByTagIn:function(t,e,n,r){var i=[];return this.each(r,function(){this.nodeName.toLowerCase()==t[1].toLowerCase()&&i.push(this)}),i},getByTagFrom:function(e,n,r){var i=[];return this.each(r,function(){var n=t.getByTag(e,this);t.each(n,function(){i.push(this)})}),i},getByPseu:function(t,e,n,r){var i=[];if(null!=r)return this.getByPseuIn(t,e,n,r);if(null!=n)return this.getByPseuFrom(t,e,n,r);if(this.qs&&(i=e.querySelectorAll(t[0])),0==i.length){var s=this.getAll(e);return this.getByPseu(t,e,n,s)}return i},getByPseuIn:function(t,e,r,i){var s=[];if("undefined"!=typeof n.pseu[t[1]]){var u=null!=t[2]?t[2].split(/\s*,\s*/):[];this.each(i,function(){n.pseu[t[1]].apply(this,u)&&s.push(this)})}return s},getByPseuFrom:function(e,n,r){var i=[];return this.each(r,function(){var n=t.getByPseu(e,this);t.each(n,function(){i.push(this)})}),i},nthChild:function(t,e,n){var r=null;return 0==e|null==e&&null!=n&&n>=0?t==n:"-"==e&&null!=n?-t+parseInt(n)>=0:null!=n?(r=(t-n)/e)!==!1&&r>=0&&parseInt(r)==r:null==n?0==t%e:!1},getNodePosition:function(t,e,n){var r=0,i=0,s=!1;return this.each(t.parentNode.childNodes,function(){(null==e||t.nodeName.toLowerCase()==e)&&i++,s||r++,t!=this||null!=e&&t.nodeName.toLowerCase()!=e||(s=!0)}),n?i-r+1:r},nth:function(e,n,r,i){var s=1,u=null;return s=t.getNodePosition(e,i,r?!0:!1),"even"==n&&0==s%2||"odd"==n&&0!=s%2||n.match(/^\d+$/)&&n==s?!0:(u=n.match(/^((-|\+)?(\d+)?)n((-|\+)\d+)?$/))?t.nthChild(s,null!=u[1]?u[1]:null,null!=u[4]?u[4]:null):!1},each:function(t,e){if(null!=t&&(null==t.length&&(t=[t]),t.length>0))for(var n=0,r=t.length;r>n;++n)1==t[n].nodeType&&e.call(t[n],n)}},e=function(){var e=function(t,e){this.pt={id:/^#([\w-]+)/,"class":/^\.([\w-]+)/,tag:/^([\w-]+)/,blank:/^\s+/,tilde:/^~\s+?/,add:/^\+\s+?/,children:/^>\s+?/,pseu:/^:([\w-]+)/,pseuArg:/^:([\w-]+)\(([^\)]+)\)/,attrCpx:/^\[([\w-]+)(=|\*=|\|=|\^=|\$=|~=)([^\]]+)\]/,attr:/^\[([\w-]+)\]/},this.str=t,this.context=e};return e.prototype={parse:function(t,e){this.match(this.pt.blank);var n=this.parseExp(t,e);return null!=n&&null==n.length?[n]:n},getChildrenExp:function(e,n){var r=[];return t.each(n,function(){t.each(this.childNodes,function(){r.push(this)})}),this.parseExp(e,r)},getSiblingExp:function(e,n){var r=[];return t.each(n,function(){var t=this.nextElementSibling;do 1==t.nodeType&&r.push(t),t=t.nextElementSibling;while(null!=t)}),this.parseExp(e,r)},getNextNodeExp:function(e,n){var r=[];return t.each(n,function(){for(var t=this.nextElementSibling;null!=t;){if(1==t.nodeType){r.push(t);break}t=t.nextElementSibling}}),this.parseExp(e,r)},parseExp:function(t,e){var n=this.parseBase(t,e);return this.match(this.pt.blank)&&this.str.length>0&&(n=null!=this.match(this.pt.children)?this.getChildrenExp(t,n):null!=this.match(this.pt.add)?this.getNextNodeExp(t,n):null!=this.match(this.pt.tilde)?this.getSiblingExp(t,n):this.parseExp(n,e)),n},parseBase:function(e,n){var r=null,i=null;if(null!=(i=this.match(this.pt.tag))){r=t.getByTag(i,this.context,e,n);var s=this.parseSuit(e,r);null!=s&&(r=s)}else r=this.parseSup(e,n);if(null==r)throw"piou-selector::parseBase: Error, node not found";return r},parseSuit:function(t,e){return this.parseSup(t,e)},parseSup:function(e,n){var r=null,i=null;if(null!=(i=this.match(this.pt.id))?r=t.getById(i,this.context,e,n):null!=(i=this.match(this.pt["class"]))?r=t.getByClass(i,this.context,e,n):(r=this.parsePseu(e,n),null==r&&(r=this.parseAttr(e,n))),null!=r){var i=this.parseSuit(e,r);null!=i&&(r=i)}return r},parsePseu:function(e,n){var r=null,i=null;return(null!=(i=this.match(this.pt.pseuArg))||null!=(i=this.match(this.pt.pseu)))&&(r=t.getByPseu(i,this.context,e,n)),r},parseAttr:function(e,n){var r=null,i=null;return(null!=(i=this.match(this.pt.attr))||null!=(i=this.match(this.pt.attrCpx)))&&(r=t.getByAttr(i,this.context,e,n)),r},match:function(t){var e=null;return(e=this.str.match(t))&&(this.str=this.str.substr(e[0].length)),e}},e}(),n=function(n,r){null==r&&(r=document);var i=[],s=n.split(/,/g);for(var u in s){var h=new e(s[u],r),l=h.parse();t.each(l,function(){i.push(this)})}return i};n.query=t,n.pseu={"first-child":function(){for(var t=this.parentNode.childNodes,e=0,n=t.length;n>e&&1!=t[e].nodeType;++e);return t[e]==this},"nth-child":function(e){return t.nth(this,e)},"nth-last-child":function(e){return t.nth(this,e,!0)},"last-child":function(){for(var t=this.parentNode.childNodes,e=t.length-1;e>0&&1!=t[e].nodeType;--e);return t[e]==this},"nth-of-type":function(e){return t.nth(this,e,!1,this.nodeName.toLowerCase())},"nth-last-of-type":function(e){return t.nth(this,e,!0,this.nodeName.toLowerCase())},"first-of-type":function(){for(var t=this.parentNode.childNodes,e=0,n=t.length;n>e&&(1!=t[e].nodeType||this.nodeName.toLowerCase()!=t[e].nodeName.toLowerCase());++e);return t[e]==this},"last-of-type":function(){for(var t=this.parentNode.childNodes,e=t.length-1;e>=0&&(1!=t[e].nodeType||this.nodeName.toLowerCase()!=t[e].nodeName.toLowerCase());--e);return t[e]==this},"only-child":function(){var e=0;return t.each(this.parentNode.childNodes,function(){e++}),1==e},empty:function(){return 0==this.childNodes.length},not:function(t){var n=new e(t,document);return 0==n.parse(null,this).length},checked:function(){return this.checked?!0:!1}},n.version="1.0.0",window.piou.selector=n}();